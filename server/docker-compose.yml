version: "3.9"

services:
  api:
    build:
      context: ..  # Build from project root to access search_number/ and .git
      dockerfile: Dockerfile  # Use Dockerfile from project root
    ports:
      - "${PORT:-8080}:8080"
    environment:
      NODE_ENV: development
      PORT: 8080
      LOG_LEVEL: debug
      ALLOW_ORIGIN: http://localhost:3000
      API_DOMAIN: http://localhost:8080
    volumes:
      - ../search_number:/app/search_number  # Mount postal code DB
      - .:/app/server
      - /app/node_modules
